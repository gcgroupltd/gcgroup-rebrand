{{ 'component-newsletter.css' | asset_url | stylesheet_tag }}
{{ 'newsletter-section.css' | asset_url | stylesheet_tag }}

{%- style -%}
    #shopify-section-{{ section.id }} .newsletter-section-full-width {
      padding: 0;
      margin: 40px 0;
    }

    #shopify-section-{{ section.id }} .newsletter-container-fw {
      display: grid;
      grid-template-columns: 1fr 1fr;
      align-items: stretch;
      overflow: hidden;
      border-radius: 8px;
      position: relative;
    }

    #shopify-section-{{ section.id }} .newsletter-content-fw {
      padding: 50px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }

    /* --- NEW: This container holds all the content and controls the width --- */
    #shopify-section-{{ section.id }} .newsletter-content-fw__inner {
      max-width: 450px;
      width: 100%;
      text-align: left;
    }

    #shopify-section-{{ section.id }} .newsletter-image-fw {
      position: relative;
      min-height: 450px;
    }

    #shopify-section-{{ section.id }} .newsletter-image-fw img {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    #shopify-section-{{ section.id }} .newsletter-heading-fw {
      font-size: 32px;
      margin-top: 0;
      margin-bottom: 15px;
      color: inherit;
    }

    #shopify-section-{{ section.id }} .newsletter-text-fw {
      font-size: 16px;
      line-height: 1.6;
      margin-bottom: 30px;
      /* max-width is now controlled by the inner container */
    }

    #shopify-section-{{ section.id }} .newsletter-form {
      max-width: 100%;
    }

    #shopify-section-{{ section.id }} .newsletter-form__message {
      color: #00af87;
    }

    #shopify-section-{{ section.id }} .newsletter-form__field-wrapper .field {
      display: flex;
      align-items: center;
      background-color: #FFFFFF;
      border: 1px solid #ccc;
      border-radius: 4px;
      overflow: hidden;
      /* max-width is now controlled by the inner container */
    }

    #shopify-section-{{ section.id }} .newsletter-form-fw__field-wrapper input {
      background: white;
    }

    #shopify-section-{{ section.id }} .newsletter-form__field-wrapper .field__input {
      flex-grow: 1;
      border: none;
      padding: 12px 15px;
      min-width: 0;
      color: #333;
      padding: 20px 15px 8px;
    }

    #shopify-section-{{ section.id }} .newsletter-form__field-wrapper .field__input:focus {
      box-shadow: none;
    }

    .newsletter-form__field-wrapper .field__label {
      /* display: none; */
        position: absolute;
    left: 15px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 1.6rem;
    color: #777;
    pointer-events: none;
    transition: all 0.2s ease;
    }

    .field__input:focus + .field__label,
  .field__input:not(:placeholder-shown) + .field__label {
    top: 6px;
    transform: translateY(0);
    font-size: 1.2rem;
    opacity: 0.8;
  }


    #shopify-section-{{ section.id }} .newsletter-form-fw__button {
      flex-shrink: 0;
      border-radius: 0;
      margin: 0;
      padding: 12px 20px;
    }

    #shopify-section-{{ section.id }} .newsletter-form-fw__button:hover {
      opacity: 0.85;
    }

    #shopify-section-{{ section.id }} .newsletter-privacy-text-fw {
      font-size: 14px;
      margin-top: 15px;
      opacity: 0.8;
      color: inherit !important;
      /* max-width is now controlled by the inner container */
    }

    #shopify-section-{{ section.id }} .newsletter-privacy-text-fw a {
      color: inherit !important;
      text-decoration: underline !important;
    }

    @media screen and (max-width: 768px) {
      #shopify-section-{{ section.id }} .newsletter-container-fw {
        grid-template-columns: 1fr;
        border-radius: 0;
        min-height: 450px;
      }

      #shopify-section-{{ section.id }} .newsletter-content-fw {
        align-items: stretch; /* Let content stretch on mobile */
        text-align: center;
        position: relative;
        z-index: 2;
        color: #FFFFFF;
        padding: 50px 20px;
      }

      #shopify-section-{{ section.id }} .newsletter-container-fw::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 1;
      }

      #shopify-section-{{ section.id }} .newsletter-image-fw {
        display: block;
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 0;
      }

      #shopify-section-{{ section.id }} .newsletter-form__field-wrapper .field {
        margin: 0 auto;
        max-width: 100%;
      }
      #shopify-section-{{ section.id }} .newsletter-privacy-text-fw {
        margin-left: auto;
        margin-right: auto;
      }

      #shopify-section-{{ section.id }} .newsletter-privacy-text-fw,
      #shopify-section-{{ section.id }} .newsletter-privacy-text-fw a {
        color: #FFFFFF !important;
      }

      #shopify-section-{{ section.id }} .newsletter-content-fw__inner {
        text-align: center; /* Center text inside the container on mobile */
      }
    }

    input {
          -webkit-appearance: none;
      appearance: none;
      /* background-color: rgb(var(--color-background));
      color: rgb(var(--color-foreground));
      font-family: var(--font-body-family);
      font-style: var(--font-body-style);
      font-weight: var(--font-body-weight); */
      font-size: 1.6rem;
      width: 100%;
      box-sizing: border-box;
      /* transition: box-shadow var(--duration-short) ease;
      border-radius: var(--inputs-radius);
      height: 4.5rem;
      min-height: calc(var(--inputs-border-width) * 2); */
      /* min-width: calc(7rem + (var(--inputs-border-width) * 2)); */
      position: relative;
      border: 0;
    }

    input::placeholder {
      opacity: 0;
    }

    .field {
      position: relative;
      width: 100%;
      display: flex;
    }

    label {
      font-size: 1.6rem;
      left: 0;
      top: 0;
      margin-bottom: 0;
      pointer-events: none;
      position: absolute;
      letter-spacing: .1rem;
      transition: all 0.25s ease-in-out;
      line-height: 1.5;
    }
{%- endstyle -%}

<div class="newsletter-section-full-width" style="background-color: {{ settings.newsletter_background }}">
  <div class="newsletter-container-fw">
    <div class="newsletter-content-fw">
      {%- comment -%} {%- endcomment -%}
      <div class="newsletter-content-fw__inner">
        <h2 class="newsletter-heading-fw">{{ settings.newsletter_title }}</h2>
        <div class="newsletter-text-fw">{{ settings.newsletter_paragraph }}</div>

        {%- form 'customer', class: 'newsletter-form' -%}
          <input type="hidden" name="contact[tags]" value="newsletter">
          <div class="newsletter-form-fw__field-wrapper">
            <div class="field">
              <input
                id="NewsletterForm--{{ section.id }}"
                type="email"
                name="contact[email]"
                class="field__input"
                value="{{ form.email }}"
                aria-required="true"
                autocorrect="off"
                autocapitalize="off"
                autocomplete="email"
                {% if form.errors %}
                  autofocus
                  aria-invalid="true"
                  aria-describedby="Newsletter-error--{{ section.id }}"
                {% elsif form.posted_successfully? %}
                  aria-describedby="Newsletter-success--{{ section.id }}"
                {% endif %}
                placeholder="Email address"
              >
              <label class="field__label" for="NewsletterForm--{{ section.id }}"> Email address </label>
              <button
                type="submit"
                class="button newsletter-form-fw__button button--black"
                name="commit"
                id="Subscribe"
              >
                {{ settings.newsletter_button_text }}
              </button>
            </div>
            {%- if form.errors -%}
              <small class="newsletter-form__message form__message" id="Newsletter-error--{{ section.id }}">
                {%- render 'icon-error' -%}
                {{ form.errors.translated_fields.email | capitalize }}
                {{ form.errors.messages.email }}
              </small>
            {%- endif -%}
          </div>
          {%- if form.posted_successfully? -%}
            <h3
              class="newsletter-form__message newsletter-form__message--success form__message"
              id="Newsletter-success--{{ section.id }}"
              tabindex="-1"
              autofocus
            >
              {%- render 'icon-success' -%}
              {{ 'newsletter.success' | t }}
            </h3>
          {%- endif -%}
        {%- endform -%}

        <div class="newsletter-privacy-text-fw">
          <p>{{ settings.newsletter_copy }}</p>
        </div>
      </div>
      {%- comment -%} {%- endcomment -%}
    </div>

    <div class="newsletter-image-fw">
      <img src="{{ settings.newsletter_image | img_url: 'large' }}" alt="">
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Newsletter",
  "blocks": [
    {
      "type": "email_form",
      "name": "t:sections.newsletter.blocks.email_form.name",
      "limit": 1
    }
  ],
  "presets": [
    {
      "name": "Newsletter"
    }
  ]
}
{% endschema %}
